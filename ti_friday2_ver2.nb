(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8460,        236]
NotebookOptionsPosition[      7999,        217]
NotebookOutlinePosition[      8365,        233]
CellTagsIndexPosition[      8322,        230]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "=", "1"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"hopping", " ", "amplitude"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", "=", "1"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"mass", " ", "amplitude"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numOfstep", "=", "30"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"number", " ", "of", " ", "iterating", " ", "steps"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"kx_", ",", "ky_", ",", "kz_", ",", "t_", ",", "m_", ",", "k0_"}],
     "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", 
         RowBox[{"(", 
          RowBox[{"2", "-", 
           RowBox[{"Cos", "[", "ky", "]"}], "-", 
           RowBox[{"Cos", "[", "kz", "]"}]}], ")"}]}], "+", 
        RowBox[{"2", "t", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", "kx", "]"}], "-", 
           RowBox[{"Cos", "[", "k0", "]"}]}], ")"}]}]}], ")"}], 
      RowBox[{"PauliMatrix", "[", "1", "]"}]}], "+", 
     RowBox[{"2", " ", "t", " ", 
      RowBox[{"Sin", "[", "ky", "]"}], 
      RowBox[{"PauliMatrix", "[", "2", "]"}]}], "+", 
     RowBox[{"2", "t", " ", 
      RowBox[{"Sin", "[", "kz", "]"}], 
      RowBox[{"PauliMatrix", "[", "3", "]"}]}]}], "//", "N"}]}], 
  RowBox[{"(*", "Hamiltonian", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"posi", "[", 
     RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", 
    RowBox[{"Sign", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Eigensystem", "[", "\[IndentingNewLine]", 
        RowBox[{"H", "[", 
         RowBox[{"kx", ",", "ky", ",", "kz", ",", "t", ",", "m", ",", "k0"}], 
         "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eigenvec", "[", 
    RowBox[{"kx_", ",", "ky_", ",", "kz_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Eigensystem", "[", "\[IndentingNewLine]", 
          RowBox[{"H", "[", 
           RowBox[{
           "kx", ",", "ky", ",", "kz", ",", "t", ",", "m", ",", "k0"}], "]"}],
           "]"}], "//", "Transpose"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", 
         RowBox[{"posi", "[", 
          RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}]}], "]"}], "]"}], "]"}], 
     "}"}], "//", "Transpose"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coupMatrix", "[", 
     RowBox[{"kxx_", ",", "kyy_", ",", "kzz_"}], "]"}], ":=", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"eigenvec", "[", 
       RowBox[{"kxx", ",", "kyy", ",", "kzz"}], "]"}], ",", 
      RowBox[{
       RowBox[{"eigenvec", "[", 
        RowBox[{"kxx", ",", "kyy", ",", "kzz"}], "]"}], "//", 
       "ConjugateTranspose"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"coupling", " ", "matrix"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Plot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"vecInitial", "=", 
         RowBox[{"eigenvec", "[", 
          RowBox[{"kx", ",", 
           RowBox[{"-", "Pi"}], ",", "kz"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"-", 
         RowBox[{"Arg", "@", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{"vecInitial", "//", "ConjugateTranspose"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Dot", "@@", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"coupMatrix", "[", 
                 RowBox[{"kx", ",", "ky", ",", "kz"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"ky", ",", 
                  RowBox[{"-", "Pi"}], ",", "Pi", ",", 
                  RowBox[{"2", 
                   RowBox[{"Pi", "/", "numOfstep"}]}]}], "}"}]}], "]"}]}], 
             RowBox[{"(*", 
              RowBox[{"prod", " ", "of", " ", "coupling", " ", "mat", " ", 
               RowBox[{"(", 
                RowBox[{"ky", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "\[CapitalPi]"}], " ", "\[Rule]", " ", "ky"}],
                   "=", "\[CapitalPi]"}]}], ")"}]}], "*)"}], 
             "\[IndentingNewLine]", ",", "vecInitial"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"kz", ",", 
         RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
       RowBox[{"PlotPoints", "\[Rule]", "50"}], ",", 
       RowBox[{"MaxRecursion", "\[Rule]", "0"}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<kz\>\"", ",", "\"\<\[Gamma]\>\""}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "Pi"}], ",", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}], ",", "0", ",", 
            RowBox[{"Pi", "/", "2"}], ",", "Pi"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "Pi"}], ",", "0", ",", "Pi"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"N", "@", "kx"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", 
       RowBox[{"-", "Pi"}], ",", "Pi", ",", "0.5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "a", "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<output.pdf\>\"", ",", "a"}], "]"}]}], "Input",
 CellChangeTimes->{{3.750730833220257*^9, 3.750730897055125*^9}, {
  3.751469552967664*^9, 3.751469556450924*^9}, {3.7514696263594637`*^9, 
  3.751469628233005*^9}, {3.751469776294063*^9, 3.751469780194252*^9}, {
  3.751470227046702*^9, 3.751470236200851*^9}, {3.7514721858726683`*^9, 
  3.7514721875779037`*^9}, {3.751478029342205*^9, 3.7514783265865717`*^9}, {
  3.7514783697269*^9, 3.7514784356272573`*^9}, {3.751491308468143*^9, 
  3.751491309500881*^9}},ExpressionUUID->"1cffa5c7-3228-458d-9f1b-\
a8550c3bba25"],

Cell[BoxData["\<\"output.pdf\"\>"], "Output",
 CellChangeTimes->{
  3.750730373950032*^9, {3.7507308401032124`*^9, 3.750730899449142*^9}, 
   3.750731469858614*^9, 3.75146955850212*^9, {3.751469622600936*^9, 
   3.7514696297904167`*^9}, 3.7514697817425747`*^9, 3.7514699760875072`*^9, {
   3.751470230313776*^9, 3.7514702382546387`*^9}, 3.751472189470574*^9, {
   3.751478024523321*^9, 3.751478241535688*^9}, {3.75147827992623*^9, 
   3.751478331651462*^9}, 3.751478417624845*^9, 
   3.7514784870912743`*^9},ExpressionUUID->"733404c4-a2c5-4421-a96d-\
6b075663c6a5"]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{202, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (2017\:5e745\
\:670816\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 6835, 181, 726, "Input", "ExpressionUUID" -> \
"1cffa5c7-3228-458d-9f1b-a8550c3bba25"],
Cell[7418, 205, 565, 9, 32, "Output", "ExpressionUUID" -> \
"733404c4-a2c5-4421-a96d-6b075663c6a5"]
}, Open  ]]
}
]
*)

